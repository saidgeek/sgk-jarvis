#!/usr/bin/env coffee

'use strict'

path = require 'path'
program = require 'commander'
Dotfiles = require '../src/dotfiles'
spawn = require('child_process').spawn
exec = require('child_process').exec
which = require('which').sync
pkg = require '../package'

console.log path.resolve(process.cwd())

program
	.version "jarvis - v#{pkg.version}"

program
	.command 'dotfiles'
	.description 'Dotfiles options'
	.option '-i, --install', 'Install dotfiles'
	.option '-d, --dir <dir>', 'Dirname to dotfiles folder'
	.action (options) ->
		args = []
		console.log options.install
		if options.install
			args.push 'setup'	if options.install and not options.dir
			args.push "setup:#{ options.dir }" if options.dir
			spawn which('grunt'), args, {
				cwd: path.join(__dirname, '..')
				env: process.env
				stdio: 'inherit'
			}
		else
			program.help()


program.parse process.argv
